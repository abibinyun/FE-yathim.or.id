---
import FacebookPixel from "../components/FacebookPixel.astro";
import SEO from "../components/SEO.astro";

export interface Props {
  title?: string;
  description?: string;
  image?: string;
  type?: string;
  canonical?: string;
  keywords?: string;
  author?: string;
  publishedTime?: string;
  modifiedTime?: string;
  noindex?: boolean;
  nofollow?: boolean;
  facebook_pixel?: string;
}

const props = Astro.props;
---

<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Favicon -->
    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="apple-touch-icon" sizes="180x180" href="/images/LOGO-YATHIM.png" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="msapplication-TileImage" content="/images/LOGO-YATHIM.png" />
    <meta name="msapplication-TileColor" content="#0ea5e9" />
    <meta name="msapplication-config" content="/browserconfig.xml" />

    <meta name="generator" content={Astro.generator} />

    <!-- SEO Component -->
    <SEO {...props} />

    <!-- ðŸ”— Preconnect ke origin penting -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://sys.yathim.or.id" crossorigin />
    <link rel="preconnect" href="https://img.youtube.com" />
    <link rel="preconnect" href="https://www.youtube.com" />

    {props.facebook_pixel && (
      <>
        <link rel="preconnect" href="https://www.facebook.com" />
        <link rel="preconnect" href="https://connect.facebook.net" crossorigin />
      </>
    )}

    <!-- ðŸ§© Preload font penting -->
    <link
      rel="preload"
      as="font"
      type="font/woff2"
      crossorigin
      href="https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7W0Q5nw.woff2"
    />
    <link
      rel="preload"
      as="font"
      type="font/woff2"
      crossorigin
      href="https://fonts.gstatic.com/s/roboto/v48/KFO7CnqEu92Fr1ME7kSn66aGLdTylUAMaxKUBHMdazTgWw.woff2"
    />
    <link
      rel="preload"
      as="font"
      type="font/woff2"
      crossorigin
      href="https://fonts.gstatic.com/s/roboto/v48/KFO7CnqEu92Fr1ME7kSn66aGLdTylUAMa3yUBHMdazQ.woff2"
    />

    <!-- ðŸ’¨ Non-blocking Google Fonts -->
    <link
      rel="preload"
      as="style"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto:wght@400;500;700&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto:wght@400;500;700&display=swap"
      media="print"
      onload="this.media='all'"
    />
    <noscript>
      <link
        rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto:wght@400;500;700&display=swap"
      />
    </noscript>

    <!-- ðŸ–¼ï¸ Preload logo (prioritas tinggi untuk LCP) -->
    <link rel="preload" as="image" href="/images/LOGO-YATHIM.png" fetchpriority="high" />

    <!-- ðŸ“Š Facebook Pixel -->
    {props.facebook_pixel && <FacebookPixel pixelId={props.facebook_pixel} />}

    <!-- âš™ï¸ Inline kecil: Defer CSS Astro hasil build (otomatis) -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll('link[rel="stylesheet"][href*="_astro"]').forEach((el) => {
          const link = el as HTMLLinkElement;
          if (link.media !== "all") link.media = "all";
        });
      });
    </script>
  </head>

  <body class="font-sans bg-white text-gray-900 antialiased">
    <slot />
  </body>
</html>
